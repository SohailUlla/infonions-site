<!-- dashboard.html -->
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Dashboard — Infonions</title>
  <meta name="description" content="User dashboard — saved matches, consultations, district snapshot, saved reports and settings." />
  <link rel="icon" href="favicon.png" />
  <link rel="stylesheet" href="style.css" />
  <style>
    /* small dashboard-specific overrides */
    .sidebar { background: linear-gradient(180deg,#fff,#fbfbff); border-radius:12px; padding:16px; box-shadow:var(--shadow) }
    .profile-pic { width:64px; height:64px; border-radius:12px; object-fit:cover; }
    .nav-vertical { display:flex; flex-direction:column; gap:8px; margin-top:12px }
    .nav-vertical button { text-align:left; padding:10px 12px; border-radius:10px; border:1px solid transparent; background:transparent; cursor:pointer }
    .nav-vertical button.active { background:linear-gradient(90deg,var(--accent),#7c3aed); color:#fff; font-weight:700 }
    .panel { background:var(--card); border-radius:12px; padding:16px; box-shadow:var(--shadow) }
    .match-item { display:flex;justify-content:space-between;align-items:center;padding:10px 0;border-bottom:1px dashed rgba(15,23,42,0.04) }
    .small-muted{font-size:13px;color:var(--muted)}
  </style>
</head>
<body>
  <header class="site-header">
    <div class="container header-inner">
      <div class="brand" onclick="goHome()">
        <img src="assets/logo.svg" alt="Infonions" class="logo" />
        <div class="brand-text">
          <div class="brand-title">Infonions</div>
          <div class="brand-sub">Personalisation powered by Real India</div>
        </div>
      </div>

      <nav class="main-nav" id="mainNav">
        <a href="index.html" class="nav-link">Home</a>
        <a href="reports.html" class="nav-link">Reports</a>
        <a href="providers.html" class="nav-link">Vendors</a>
        <a href="contact.html" class="nav-link">Contact</a>
        <a class="btn btn-primary" href="index.html">Log out</a>
      </nav>

      <button class="nav-toggle" id="navToggle" aria-label="Open menu">☰</button>
    </div>
  </header>

  <main class="container" style="padding-top:24px">
    <div style="display:grid;grid-template-columns:280px 1fr;gap:18px;align-items:start">
      <!-- SIDEBAR -->
      <aside class="sidebar">
        <div style="display:flex;gap:12px;align-items:center">
          <img src="assets/profile-placeholder.jpg" alt="You" class="profile-pic" />
          <div>
            <div style="font-weight:700">Sohail Ulla</div>
            <div class="small-muted">Hyderabad • Budget: ₹10,000</div>
          </div>
        </div>

        <div class="nav-vertical" style="margin-top:18px">
          <button class="active" data-panel="overview">Overview</button>
          <button data-panel="matches">Saved Matches</button>
          <button data-panel="consults">Consultations</button>
          <button data-panel="reports">Saved Reports</button>
          <button data-panel="settings">Settings</button>
        </div>

        <div style="margin-top:18px">
          <div class="small-muted">District Score</div>
          <div style="font-weight:700;font-size:20px;color:var(--accent);margin-top:6px">62 / 100</div>
          <div class="small-muted" style="margin-top:6px">Last updated: 3 days ago</div>
        </div>

        <div style="margin-top:16px">
          <button class="btn btn-outline full" id="requestConsult">Request Consultation</button>
        </div>
      </aside>

      <!-- MAIN PANELS -->
      <section>
        <!-- Overview -->
        <div id="panel-overview" class="panel" style="margin-bottom:16px">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div>
              <div style="font-weight:700;font-size:18px">Welcome back, Sohail</div>
              <div class="small-muted">Here are your latest matches and saved reports</div>
            </div>

            <div style="display:flex;gap:8px;align-items:center">
              <div class="small-muted" style="text-align:right">
                <div>Saved matches</div>
                <div style="font-weight:700">6</div>
              </div>

              <div class="small-muted" style="text-align:right">
                <div>Saved reports</div>
                <div style="font-weight:700">3</div>
              </div>
            </div>
          </div>

          <div style="margin-top:14px;display:grid;grid-template-columns:1fr 320px;gap:12px">
            <div>
              <div style="font-weight:700;margin-bottom:8px">Latest Matches</div>
              <div id="matchesList" style="background:linear-gradient(180deg,#fff,#fbfdff);border-radius:10px;padding:8px">
                <!-- JS populates -->
              </div>

              <div style="margin-top:12px">
                <div style="font-weight:700;margin-bottom:8px">Personal Recommendations</div>
                <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:8px">
                  <div class="card">
                    <div style="font-weight:700">Affordable Phone</div>
                    <div class="small-muted">Seller: LocalStore — ₹8,900</div>
                    <div style="margin-top:8px"><button class="btn btn-ghost">View</button></div>
                  </div>
                  <div class="card">
                    <div style="font-weight:700">Skill Training</div>
                    <div class="small-muted">SkillUp — 3 months, ₹6,000</div>
                    <div style="margin-top:8px"><button class="btn btn-primary">Enroll</button></div>
                  </div>
                </div>
              </div>
            </div>

            <aside>
              <div class="panel" style="margin-bottom:12px">
                <div style="font-weight:700">Area Snapshot</div>
                <div class="small-muted" style="margin-top:8px">Hyderabad • Living Score: <strong style="color:var(--accent)">62</strong></div>
                <div style="margin-top:8px">
                  <div class="small-muted">Top needs:</div>
                  <ul style="padding-left:18px;color:var(--muted);margin-top:8px">
                    <li>Affordable electronics</li>
                    <li>Skill development</li>
                    <li>Home repair services</li>
                  </ul>
                </div>
              </div>

              <div class="panel">
                <div style="font-weight:700">Notifications</div>
                <div class="small-muted" style="margin-top:8px">You have <strong>2</strong> new matches waiting.</div>
                <div style="margin-top:8px"><button class="btn btn-primary full">View notifications</button></div>
              </div>
            </aside>
          </div>
        </div>

        <!-- Saved Matches -->
        <div id="panel-matches" class="panel" style="display:none;margin-bottom:16px">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div style="font-weight:700">Saved Matches</div>
            <div class="small-muted">Manage your saved vendor matches</div>
          </div>

          <div style="margin-top:12px" id="savedMatches">
            <!-- JS -->
          </div>

          <div style="margin-top:12px" class="center">
            <button class="btn btn-outline" id="exportMatches">Export matches</button>
          </div>
        </div>

        <!-- Consultations -->
        <div id="panel-consults" class="panel" style="display:none;margin-bottom:16px">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div style="font-weight:700">Consultations</div>
            <div class="small-muted">Chat with a consultant or request a callback</div>
          </div>

          <div style="margin-top:12px;display:grid;grid-template-columns:1fr 340px;gap:12px">
            <div class="card" style="min-height:220px">
              <div style="font-weight:700">Active chats</div>
              <div id="chatList" style="margin-top:8px">
                <!-- JS -->
              </div>

              <div style="margin-top:12px">
                <textarea id="newMessage" placeholder="Write a message to consultant..." style="width:100%;min-height:70px;padding:10px;border-radius:10px;border:1px solid #e6e9ef"></textarea>
                <div style="margin-top:8px;display:flex;gap:8px">
                  <button id="sendMsg" class="btn btn-primary">Send</button>
                  <button id="requestCall" class="btn btn-ghost">Request Callback</button>
                </div>
              </div>
            </div>

            <aside class="panel">
              <div style="font-weight:700">Consultant Info</div>
              <div class="small-muted" style="margin-top:8px">A consultant will usually reply within 24 hours. For urgent issues use partners@infonions.com</div>
              <div style="margin-top:12px"><button class="btn btn-primary full" id="startConsult">Start New Consultation</button></div>
            </aside>
          </div>
        </div>

        <!-- Reports -->
        <div id="panel-reports" class="panel" style="display:none;margin-bottom:16px">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div style="font-weight:700">Saved Reports</div>
            <div class="small-muted">Download or share district reports you saved</div>
          </div>

          <div style="margin-top:12px" id="savedReports">
            <!-- JS -->
          </div>
        </div>

        <!-- Settings -->
        <div id="panel-settings" class="panel" style="display:none;margin-bottom:16px">
          <div style="font-weight:700">Settings</div>
          <div class="small-muted" style="margin-top:8px">Manage profile, privacy and notification preferences.</div>

          <form id="settingsForm" style="margin-top:12px">
            <div style="display:flex;gap:8px;flex-wrap:wrap">
              <input id="s_name" placeholder="Full name" style="padding:10px;border-radius:10px;border:1px solid #e6e9ef" />
              <input id="s_city" placeholder="City / District" style="padding:10px;border-radius:10px;border:1px solid #e6e9ef" />
            </div>

            <div style="margin-top:10px">
              <label class="small-muted">Email notifications</label>
              <div style="display:flex;gap:8px;margin-top:8px">
                <label><input type="checkbox" id="notifEmail" checked /> Matches & Reports</label>
                <label><input type="checkbox" id="notifVendors" checked /> Vendor messages</label>
              </div>
            </div>

            <div style="margin-top:12px;display:flex;gap:8px">
              <button class="btn btn-primary" id="saveSettings">Save settings</button>
              <button type="button" class="btn btn-outline" id="deleteAccount">Delete account</button>
            </div>
          </form>
        </div>
      </section>
    </div>
  </main>

  <footer class="site-footer" style="margin-top:28px">
    <div class="container footer-inner">
      <div class="footer-left">
        <img src="assets/logo-sm.svg" alt="Infonions" class="logo-sm" />
        <div class="muted small">© <span id="year"></span> Infonions • Personal life consulting powered by real data</div>
      </div>

      <div class="footer-right">
        <a class="muted" href="privacy.html">Privacy</a>
        <a class="muted" href="contact.html">Contact</a>
      </div>
    </div>
  </footer>

  <script src="script.js"></script>
  <script>
    // dashboard demo logic
    document.addEventListener('DOMContentLoaded', () => {
      document.getElementById('year').textContent = new Date().getFullYear();

      // sidebar navigation
      const tabs = document.querySelectorAll('.nav-vertical button');
      tabs.forEach(btn => btn.addEventListener('click', () => {
        tabs.forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        const panel = btn.getAttribute('data-panel');
        showPanel(panel);
      }));

      // initial populate
      populateMatches();
      populateSavedReports();
      populateChats();

      // action bindings
      document.getElementById('exportMatches').addEventListener('click', exportMatches);
      document.getElementById('requestConsult').addEventListener('click', () => { showPanel('consults'); alert('Consultation request opened (demo).'); });
      document.getElementById('startConsult').addEventListener('click', () => { showPanel('consults'); alert('Starting a new consultation (demo).'); });

      document.getElementById('sendMsg').addEventListener('click', () => {
        const txt = document.getElementById('newMessage').value.trim();
        if (!txt) return alert('Type a message first.');
        addChatMessage('You', txt);
        document.getElementById('newMessage').value = '';
        setTimeout(() => addChatMessage('Consultant', 'Thanks — we will look into this and reply soon.'), 900);
      });

      document.getElementById('saveSettings').addEventListener('click', (e) => {
        e.preventDefault();
        alert('Settings saved (demo).');
      });

      document.getElementById('deleteAccount').addEventListener('click', () => {
        if (confirm('Are you sure you want to delete your account? This is irreversible.')) {
          alert('Account deletion requested (demo).');
        }
      });

      function showPanel(name) {
        const panels = ['overview','matches','consults','reports','settings'];
        panels.forEach(p => {
          const el = document.getElementById('panel-' + p);
          if (!el) return;
          el.style.display = (p === name) ? 'block' : 'none';
        });
        // scroll to top of main content
        window.scrollTo({ top: 0, behavior: 'smooth' });
      }

      function populateMatches() {
        const items = [
          {id:1,title:'Affordable Phone — LocalStore', price:'₹8,900', note:'Seller near you, EMI available'},
          {id:2,title:'Tailor — Quality stitching', price:'₹700', note:'Affordable rates'},
          {id:3,title:'Home Repair — QuickRepair', price:'₹1,200', note:'Verified technicians'}
        ];
        const container = document.getElementById('matchesList');
        container.innerHTML = items.map(i => `
          <div class="match-item">
            <div>
              <div style="font-weight:700">${i.title}</div>
              <div class="small-muted">${i.note}</div>
            </div>
            <div style="text-align:right">
              <div style="font-weight:700">${i.price}</div>
              <div style="margin-top:8px">
                <button class="btn btn-ghost" onclick="viewMatch(${i.id})">View</button>
                <button class="btn btn-primary" onclick="contactMatch(${i.id})">Contact</button>
              </div>
            </div>
          </div>
        `).join('');
        // also populate savedMatches panel
        const saved = document.getElementById('savedMatches');
        if (saved) saved.innerHTML = items.map(i => `<div class="match-item"><div><div style="font-weight:700">${i.title}</div><div class="small-muted">${i.note}</div></div><div><button class="btn btn-ghost" onclick="viewMatch(${i.id})">View</button> <button class="btn btn-outline" onclick="removeMatch(${i.id})">Remove</button></div></div>`).join('');
      }

      function populateSavedReports() {
        const reports = [
          {id:1,title:'Hyderabad — Living Score (2025)', file:'#'},
          {id:2,title:'Telangana — Employment Heatmap (2025)', file:'#'}
        ];
        const container = document.getElementById('savedReports');
        if (!container) return;
        container.innerHTML = reports.map(r => `<div style="padding:12px;border-bottom:1px dashed rgba(15,23,42,0.04)"><div style="font-weight:700">${r.title}</div><div class="small-muted" style="margin-top:6px"><a class="btn btn-ghost" href="${r.file}">Download</a> <button class="btn btn-outline" onclick="removeReport(${r.id})">Remove</button></div></div>`).join('');
      }

      function populateChats() {
        const chats = [
          {id:1,with:'Consultant',last:'We have recommended a local seller.'},
          {id:2,with:'Vendor — LocalStore',last:'Your question about EMI was answered.'}
        ];
        const container = document.getElementById('chatList');
        if (!container) return;
        container.innerHTML = chats.map(c => `<div style="padding:8px 0;border-bottom:1px dashed rgba(15,23,42,0.04)"><div style="font-weight:700">${c.with}</div><div class="small-muted">${c.last}</div></div>`).join('');
      }

      // exported functions to window for buttons created inline
      window.viewMatch = (id) => { alert('View match ' + id + ' (demo)'); }
      window.contactMatch = (id) => { alert('Contacting match ' + id + ' (demo)'); }
      window.removeMatch = (id) => { if (confirm('Remove this match?')) { alert('Removed ' + id + ' (demo)'); populateMatches(); } }
      window.removeReport = (id) => { if (confirm('Remove saved report?')) { alert('Removed report ' + id + ' (demo)'); populateSavedReports(); } }
      window.exportMatches = exportMatches;
      function exportMatches() {
        const csv = 'Title,Note,Price\nAffordable Phone,EMI available,8900\nTailor,Affordable rates,700\nHome Repair,Verified technicians,1200\n';
        const blob = new Blob([csv], { type: 'text/csv' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a'); a.href = url; a.download = 'infonions-saved-matches.csv'; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
      }

      function addChatMessage(who, text) {
        const container = document.getElementById('chatList');
        if (!container) return;
        const node = document.createElement('div');
        node.style.padding = '8px 0';
        node.style.borderBottom = '1px dashed rgba(15,23,42,0.04)';
        node.innerHTML = `<div style="font-weight:700">${who}</div><div class="small-muted">${text}</div>`;
        container.prepend(node);
      }
    });
  </script>
</body>
</html>
