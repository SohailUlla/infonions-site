<script>
function getQueryParam(name) {
  const url = new URL(window.location.href);
  return url.searchParams.get(name);
}

async function loadFullArticle() {
  const filePath = getQueryParam("file");
  const container = document.getElementById("articleContainer");

  if (!filePath) {
    container.innerHTML = "<p>Article not found.</p>";
    return;
  }

  const res = await fetch(filePath);
  const text = await res.text();

  const title = (text.match(/title:\s*(.*)/) || [])[1] || "Article";
  const impact = (text.match(/impact:\s*(.*)/) || [])[1] || "Medium";
  const domain = (text.match(/domain:\s*(.*)/) || [])[1] || "General";

  // Correct body extraction
  let body = "";
  const bodyMatch = text.match(/body:\s*\|\s*([\s\S]*)/);

  if (bodyMatch) {
    body = bodyMatch[1].trim();
  }

  container.innerHTML = `
    <article class="signal-card high">

      <div class="signal-meta">
        <span class="impact high">${impact.toUpperCase()} IMPACT</span>
        <span class="domain">${domain.toUpperCase()}</span>
      </div>

      <h1>${title}</h1>

      <div class="signal-summary" style="white-space: pre-line;">
        ${body}
      </div>

    </article>
  `;
}

loadFullArticle();
</script>
