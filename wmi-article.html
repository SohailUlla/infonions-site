<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Article | Infonions</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="assets/style.css">
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>
<body>

<section class="signals-core">
  <div id="articleContainer" style="padding:40px; color:white;">
    Loading article...
  </div>
</section>

<section style="text-align:center; padding:40px;">
  <a href="Insights-moving.html" class="btn btn-primary">
    ← Back to What’s Moving India
  </a>
</section>

<script>
function getQueryParam(name) {
  const url = new URL(window.location.href);
  return url.searchParams.get(name);
}

async function loadFullArticle() {
  const filePath = getQueryParam("file");
  const container = document.getElementById("articleContainer");

  if (!container) {
    console.error("Container missing");
    return;
  }

  if (!filePath) {
    container.innerHTML = "<p>Article not found.</p>";
    return;
  }

  try {
    const res = await fetch(filePath);
    const text = await res.text();

    const title = (text.match(/title:\s*(.*)/) || [])[1] || "Article";
    const impact = (text.match(/impact:\s*(.*)/) || [])[1] || "Medium";
    const domain = (text.match(/domain:\s*(.*)/) || [])[1] || "General";

    let body = "";
    const bodyMatch = text.match(/date:.*\n([\s\S]*)/);

    if (bodyMatch) {
      body = bodyMatch[1].trim();
    }

    container.innerHTML = `
      <article class="signal-card high" style="padding:40px;">

        <div class="signal-meta">
          <span class="impact high">${impact.toUpperCase()} IMPACT</span>
          <span class="domain">${domain.toUpperCase()}</span>
        </div>

        <h1 style="margin-top:20px;">${title}</h1>

        <div class="signal-summary" style="white-space: pre-line; margin-top:20px;">
          ${body}
        </div>

      </article>
    `;
  } catch (err) {
    container.innerHTML = "<p>Failed to load article.</p>";
    console.error(err);
  }
}

loadFullArticle();
</script>

</body>
</html>
